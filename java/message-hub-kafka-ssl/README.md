### message-hub-kafka-ssl
This Java sample can connect to one of the Message Hub Kafka endpoints. After it
has connected, it will produce and consume three messages before exiting.

## Prerequisites
To build and run the sample, you must have the following installed:
* [git](https://git-scm.com/)
* [Gradle](https://gradle.org/)
* Java 7+

## Building the Sample

#### Updating the Properties Files
Firstly, you will need to update the consumer and producer properties files. These can be found
in the ```resources``` directory. The only keys you need to update in each of the consumer and
producer properties files are the following:

* ssl.truststore.location
  * Set to the location of the `cacerts` file, most commonly located in _java.home_/lib/security
* ssl.truststore.password
  * If you have not changed the password, the default is _changeit_

#### Updating SASL Configuration
Finally, the `jaas.conf` configuration file needs to be updated. Most fields are filled out for you already, however, the fields listed below need to be updated:

* username
  * Set to the username described in your Message Hub Bluemix credentials
* password
  * Set to the password described in your Message Hub Bluemix credentials

#### Running the Build Script
After updating the properties and configuration files, run the following commands:
```shell
gradle clean && gradle build
 ```

This will download the required dependencies and copy any files located in the lib-message-hub directory.
Once built, the sample can be located in the `build/libs` directory, along with the `resources` folder.

## Running the Sample
To run the sample, navigate to the `build/libs` directory and run the following command:
```shell
java -Djava.security.auth.login.config=resources/jaas.conf -jar <name_of_jar>.jar <kafka_endpoint> <rest_endpoint> <api_key>
```

__Note:__ As the sample now uses SASL, the port required for the Kafka endpoint is 9094, rather than 9093.

## Sample Output
Below is a snippet of the output generated by the sample. Note that the sample will also create
a topic for you.

```
class com.example.ConsumerRunnable is starting.
class com.example.ProducerRunnable is starting.
Message produced, offset: 0
Message produced, offset: 1
Message produced, offset: 2
class com.example.ProducerRunnable is shutting down.
Message: [{"value":"This is a test message0"}]
Message: [{"value":"This is a test message1"}]
Message: [{"value":"This is a test message2"}]
class com.example.ConsumerRunnable is shutting down.
```
